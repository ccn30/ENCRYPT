tgridcodeimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_final_X_resultsv1.csv');
tgridtaskimport = read.csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/$csv_result_files/gridCATbehaviourresults.csv');
strucdataimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/$csv_result_files/tSNR.csv')
voxeldataimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/GridCatVoxels.csv')
######### TIDY DATA #############
# recode subject to factor
tgridcodeimport[,1] <- lapply(tgridcodeimport[,1],factor)
strucdataimport[,1:2] <- lapply(strucdataimport[,1:2],factor)
# recode age cont to cat
tgridcode1 <- tgridcodeimport %>% mutate(Age_Group=cut(Age,breaks = c(-Inf, 30, Inf), labels = c("Young","Old")))
# Stats on gridcode metrics
require(ggplot2)
require(dplyr)
require(tibble)
require(readr)
require(tidyr)
require(RColorBrewer)
require(ggthemes)
require(lme4)
# load in data
tgridcodeimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_final_X_resultsv1.csv');
tgridtaskimport = read.csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/$csv_result_files/gridCATbehaviourresults.csv');
strucdataimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/$csv_result_files/tSNR.csv')
voxeldataimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/GridCatVoxels.csv')
######### TIDY DATA #############
# recode subject to factor
tgridcodeimport[,1] <- lapply(tgridcodeimport[,1],factor)
strucdataimport[,1:2] <- lapply(strucdataimport[,1:2],factor)
# recode age cont to cat
tgridcode1 <- tgridcodeimport %>% mutate(Age_Group=cut(Age,breaks = c(-Inf, 30, Inf), labels = c("Young","Old")))
View(tgridcodeimport)
# Stats on gridcode metrics
require(ggplot2)
require(dplyr)
require(tibble)
require(readr)
require(tidyr)
require(RColorBrewer)
require(ggpu)
require(ggthemes)
# load in data
tgridcodeimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_final_X_resultsv1.csv');
tgridtaskimport = read.csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/$csv_result_files/gridCATbehaviourresults.csv');
strucdataimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/$csv_result_files/tSNR.csv')
voxeldataimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/GridCatVoxels.csv')
######### TIDY DATA #############
# recode subject to factor
tgridcodeimport[,1] <- lapply(tgridcodeimport[,1],factor)
strucdataimport[,1:2] <- lapply(strucdataimport[,1:2],factor)
# recode age cont to cat
tgridcode1 <- tgridcodeimport %>% mutate(Age_Group=cut(Age,breaks = c(-Inf, 30, Inf), labels = c("Young","Old")))
# Stats on gridcode metrics
require(ggplot2)
require(dplyr)
require(tibble)
require(readr)
require(tidyr)
require(RColorBrewer)
require(ggthemes)
require(lme4)
# load in data
tgridcodeimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_final_X_resultsv1.csv');
tgridtaskimport = read.csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/$csv_result_files/gridCATbehaviourresults.csv');
strucdataimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/$csv_result_files/tSNR.csv')
voxeldataimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/GridCatVoxels.csv')
######### TIDY DATA #############
# recode subject to factor
tgridcodeimport[,1] <- lapply(tgridcodeimport[,1],factor)
strucdataimport[,1:2] <- lapply(strucdataimport[,1:2],factor)
# recode age cont to cat
tgridcode1 <- tgridcodeimport %>% mutate(Age_Group=cut(Age,breaks = c(-Inf, 30, Inf), labels = c("Young","Old")))
# get magnitude
grid.mag.untidy <- tgridcode1 %>% select(Subject,Age,Age_Group,Gender,starts_with("GCmagnitude"))
grid.mag <- grid.mag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
grid.mag.sep <- separate(grid.mag,Model,c(NA,"Run",NA,NA,NA,"Model"),"_")
rm(grid.mag,grid.mag.untidy)
# get spatial stability
#Rayleigh Z
grid.sStability.z.untidy <- tgridcode1 %>% select(Subject,Age,Age_Group,Gender,starts_with("sStability_zRay"))
grid.sStability.z <- grid.sStability.z.untidy %>% gather(Model,Grid_sStabilityZ,starts_with("sStability"))
grid.sStability.z.sep <- separate(grid.sStability.z,Model,c(NA,NA,"Run",NA,NA,NA,"Model"),"_")
rm(grid.sStability.z,grid.sStability.z.untidy)
#Rayleigh p
grid.sStability.p.untidy <- tgridcode1 %>% select(Subject,Age,Age_Group,Gender,starts_with("sStability_pRay"))
grid.sStability.p <- grid.sStability.p.untidy %>% gather(Model,Grid_sStabilityP,starts_with("sStability"))
grid.sStability.p.sep <- separate(grid.sStability.p,Model,c(NA,NA,"Run",NA,NA,NA,"Model"),"_")
rm(grid.sStability.p.untidy,grid.sStability.p)
# get temporal stability
grid.tStability.untidy <- tgridcode1 %>% select(Subject,Age,Age_Group,Gender,starts_with("tStability"))
grid.tStability <- grid.tStability.untidy %>% gather(Model,Grid_tStability,starts_with("tStability"))
grid.tStability.sep <- separate(grid.tStability,Model,c(NA,NA,"RunComparison",NA,NA,NA,"Model"),"_")
rm(grid.tStability.untidy,grid.tStability)
# Stats on gridcode metrics
require(ggplot2)
require(dplyr)
require(tibble)
require(readr)
require(tidyr)
require(RColorBrewer)
require(ggthemes)
require(lme4)
# load in data
tgridcodeimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_final_X_resultsv1.csv');
tgridtaskimport = read.csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/$csv_result_files/gridCATbehaviourresults.csv');
strucdataimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/$csv_result_files/tSNR.csv')
voxeldataimport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/GridCatVoxels.csv')
######### TIDY DATA #############
# recode subject to factor
tgridcodeimport[,1] <- lapply(tgridcodeimport[,1],factor)
strucdataimport[,1:2] <- lapply(strucdataimport[,1:2],factor)
# recode age cont to cat
tgridcode1 <- tgridcodeimport %>% mutate(Age_Group=cut(Age,breaks = c(-Inf, 30, Inf), labels = c("Young","Old")))
# get magnitude
grid.mag.untidy <- tgridcode1 %>% select(Subject,Age,Age_Group,Gender,starts_with("GCmagnitude"))
grid.mag <- grid.mag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
grid.mag.sep <- separate(grid.mag,Model,c(NA,"Run",NA,NA,NA,"Model"),"_")
rm(grid.mag,grid.mag.untidy)
# get spatial stability
#Rayleigh Z
grid.sStability.z.untidy <- tgridcode1 %>% select(Subject,Age,Age_Group,Gender,starts_with("sStability_zRay"))
grid.sStability.z <- grid.sStability.z.untidy %>% gather(Model,Grid_sStabilityZ,starts_with("sStability"))
grid.sStability.z.sep <- separate(grid.sStability.z,Model,c(NA,NA,"Run",NA,NA,NA,"Model"),"_")
rm(grid.sStability.z,grid.sStability.z.untidy)
#Rayleigh p
grid.sStability.p.untidy <- tgridcode1 %>% select(Subject,Age,Age_Group,Gender,starts_with("sStability_pRay"))
grid.sStability.p <- grid.sStability.p.untidy %>% gather(Model,Grid_sStabilityP,starts_with("sStability"))
grid.sStability.p.sep <- separate(grid.sStability.p,Model,c(NA,NA,"Run",NA,NA,NA,"Model"),"_")
rm(grid.sStability.p.untidy,grid.sStability.p)
# get temporal stability
grid.tStability.untidy <- tgridcode1 %>% select(Subject,Age,Age_Group,Gender,starts_with("tStability"))
grid.tStability <- grid.tStability.untidy %>% gather(Model,Grid_tStability,starts_with("tStability"))
grid.tStability.sep <- separate(grid.tStability,Model,c(NA,NA,"RunComparison",NA,NA,NA,"Model"),"_")
rm(grid.tStability.untidy,grid.tStability)
head(grid.mag.sep)
head(grid.tStability.sep)
head(grid.sStability.p.sep)
grid.mag.all.allRuns <- grid.mag.sep %>%
filter(Run == "allRuns")
grid.mag.main.allRuns <- grid.mag.all.allRuns %>%
filter(Model %in% c("pmBoth6","pmRight6","pmLeft6"))
pd <- position_dodge(0.2)
ggplot(grid.mag.main.allRuns, aes(Model,Grid_Magnitude,fill=Model)) +
geom_boxplot(position="dodge",alpha=0.6) +
geom_line(aes(group=Subject),position = pd) +
geom_point(aes(fill=Model,group=Subject),size=2,shape=21,position = pd) +
scale_fill_brewer(palette="GnBu") +
labs(title = "Average Grid Magnitude in pmEC")
grid.mag.ROIcontrols.allRuns <- grid.mag.all.allRuns %>%
filter(Model %in% c("alRight6","pmRight6","alLeft6","pmLeft6")) %>%
mutate(Side = factor(case_when(Model %in% c("alRight6","pmRight6") ~ "Right", Model %in% c("pmLeft6","alLeft6") ~ "Left")))
pd <- position_dodge(0.2)
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
labs(title = "Average Grid Magnitude, pm vs al EC")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude,fill = Model)) +
geom_boxplot(outlier.shape = NA,alpha=0.6) +
geom_point(aes(fill=Model),size=2,shape=21,position=position_jitterdodge(0.2)) +
facet_grid(~Age_Group) +
scale_fill_brewer(palette="GnBu") +
labs(title = "Average Grid Magnitude, pm vs al EC")
interaction.plot(grid.mag.ROIcontrols.allRuns$Model,grid.mag.ROIcontrols.allRuns$Age_Group,grid.mag.ROIcontrols.allRuns$Grid_Magnitude)
t.test(Grid_Magnitude~Model,data=filter(grid.mag.ROIcontrols.allRuns,Side == "Right"),alternative="two.sided",paired = TRUE, var.equal=TRUE)
t.test(Grid_Magnitude~Model,data=filter(grid.mag.ROIcontrols.allRuns,Side == "Left"),alternative="two.sided",paired = TRUE, var.equal=TRUE)
grid.mag.pmR.allRuns <- grid.mag.all.allRuns %>%
filter(Model %in% c("pmRight4","pmRight5","pmRight6","pmRight7","pmRight8"))
grid.mag.pmL.allRuns <- grid.mag.all.allRuns %>%
filter(Model %in% c("pmLeft4","pmLeft5","pmLeft6","pmLeft7","pmLeft8"))
ggplot(grid.mag.pmL.allRuns, aes(Model,Grid_Magnitude,fill = Model)) +
geom_boxplot(outlier.shape = NA,alpha=0.6) +
geom_point(aes(fill=Model),size=2,shape=21,position=position_jitterdodge(0.2)) +
#facet_wrap(~Age_Group) +
scale_fill_brewer(palette="Reds") +
labs(title = "Left pmEC average Grid Magnitude across different symmetries")
ggplot(grid.mag.pmR.allRuns, aes(Model,Grid_Magnitude,fill = Model)) +
geom_boxplot(outlier.shape = NA,alpha=0.6) +
geom_point(aes(fill=Model),size=2,shape=21,position=position_jitterdodge(0.2)) +
scale_fill_brewer(palette="Oranges") +
labs(title = "Right pmEC average Grid Magnitude across different symmetries") +
theme_linedraw()
lm.grid.mag.controlmod.R <- lm(data=grid.mag.pmR.allRuns,Grid_Magnitude~Model + Age_Group + Model)
anova(lm.grid.mag.controlmod.R)
summary(lm.grid.mag.controlmod.R)
anova.grid.mag.controlmod.R <- aov(lm.grid.mag.controlmod.R)
posthoc.grid.mag.controlmod.R <- TukeyHSD(anova.grid.mag.controlmod.R, "Model",ordered=FALSE,conf.level = 0.95)
posthoc.grid.mag.controlmod.R
lmer.grid.mag.controlmod.R <- lmer(data=grid.mag.pmR.allRuns,Grid_Magnitude~Model + Age + (1|Subject))
ggplot(grid.mag.main.allRuns, aes(Model,Grid_Magnitude,fill=Age_Group)) +
geom_boxplot(position="dodge",alpha=0.6) +
geom_point(aes(fill=Age_Group),size=2,shape=21,position=position_jitterdodge(0.2)) +
labs(title = "Average Grid Magnitude in pmEC") +
#facet_wrap(~Age_Group) +
scale_fill_manual(values=c("#E69F00","#56B4E9")) +
theme(plot.background=element_rect(fill="grey92"))
grid.mag.main2.allRuns <- grid.mag.all.allRuns %>%
filter(Model %in% c("pmRight6","pmLeft6"))
ggplot(grid.mag.main2.allRuns,aes(Age,Grid_Magnitude,fill=Model)) +
geom_jitter() +
#facet_wrap(~Model) +
geom_smooth(aes(colour=TRUE),method=lm) +
scale_color_brewer(palette="Blues") +
labs(title="Association of grid magnitude with age")
struc.main <- strucdataimport %>%
filter(Side %in% c("pmRight","pmLeft","bilateral"))
struc.control <- strucdataimport %>%
filter(!Side %in% c("pmRight","pmLeft","bilateral"))
# combine structural and magnitude data for main models
#grid.mag.main.allRuns.side <- grid.mag.main.allRuns %>%
#  mutate(Side = case_when(Model %in% pmLeft6 ~ "pmLeft", Model %in% pmRight6 ~ "pmRight"))
grid.avmagStruc.L <- bind_cols(filter(struc.main,Side == "pmLeft"),filter(grid.mag.main.allRuns, Model == "pmLeft6"),filter(voxeldataimport,Side == "pmLeft")) %>%
select(Subject,Volume,Mean_tSNR,Age,Age_Group,Side,Gender,Grid_Magnitude,Mask_Voxels)
grid.avmagStruc.R <- bind_cols(filter(struc.main,Side == "pmRight"),filter(grid.mag.main.allRuns, Model == "pmRight6"), filter(voxeldataimport,Side == "pmRight")) %>%
select(Subject,Volume,Mean_tSNR,Age,Age_Group,Side,Gender,Grid_Magnitude,Mask_Voxels)
grid.avmagStruc.bilat <- bind_cols(filter(struc.main,Side == "bilateral"),filter(grid.mag.main.allRuns, Model == "pmBoth6")) %>% select(Subject,Volume,Mean_tSNR,Age,Age_Group,Side,Gender,Grid_Magnitude)
grid.avmagStruc.main <- rbind(grid.avmagStruc.L,grid.avmagStruc.R)
#rm(grid.avmagStruc.R,grid.avmagStruc.L)
# combine structural and magnitude data for control models
grid.avmagStruc.control.L <- bind_cols(filter(struc.control,Side == "alLeft"),filter(grid.mag.all.allRuns, Model == "alLeft6")) %>%
select(Subject,Volume,Mean_tSNR,Age,Age_Group,Side,Gender,Grid_Magnitude)
grid.avmagStruc.control.R <- bind_cols(filter(struc.control,Side == "alRight"),filter(grid.mag.all.allRuns, Model == "alRight6")) %>%
select(Subject,Volume,Mean_tSNR,Age,Age_Group,Side,Gender,Grid_Magnitude)
grid.avmagStruc.control <- rbind(grid.avmagStruc.control.L,grid.avmagStruc.control.R)
#rm(grid.avmagStruc.control.L,grid.avmagStruc.control.R)
# combine main and control sets
grid.avmagStruc.allmodels <- rbind(grid.avmagStruc.control,grid.avmagStruc.main[,-9])
# right side only
grid.avmagStruc.Rmodels <- grid.avmagStruc.allmodels %>% filter(Side %in% c("pmRight","alRight"))
#left side only
grid.avmagStruc.Lmodels <- grid.avmagStruc.allmodels %>% filter(Side %in% c("pmLeft","alLeft"))
lm.grid.mag.main.full <- lm(data=grid.avmagStruc.main, Grid_Magnitude~Age + Mean_tSNR + Volume + Gender + Side)
# + Side:Age + Side:Mean_tSNR + Age:Mean_tSNR + Side:Age:Mean_tSNR
summary(lm.grid.mag.main.full)
anova(lm.grid.mag.main.full)
lmer.grid.mag.main.full <- lmer(data=grid.avmagStruc.main, Grid_Magnitude~Age + Mean_tSNR + Volume + (1|Subject) + Side,control=lmerControl(check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))
summary(lmer.grid.mag.main.full)
anova(lmer.grid.mag.main.full)
par(mfrow=c(2,2))
plot(lm.grid.mag.main.full)
tsnr.ROIs <- strucdataimport %>% filter(Side != "bilateral") %>%
#filter(Side %in% c("pmRight","pmLeft"))
mutate(Hemisphere = factor(case_when(Side %in% c("alRight","pmRight") ~ "Right", Side %in% c("pmLeft","alLeft") ~ "Left")))
ggplot(tsnr.ROIs, aes(Side,Mean_tSNR,fill=Side)) +
geom_boxplot(outlier.shape = NA,alpha=0.6) +
geom_point(aes(fill=Side,colour=Side),size=2,shape=21,position=position_jitterdodge(0.2)) +
facet_grid(~Hemisphere,scales="free") +
scale_color_brewer(palette="Spectral") +
scale_fill_brewer(palette="Spectral")
labs(title = "Mean tSNR across ROIs")
t.test(Mean_tSNR~Side,data=filter(tsnr.ROIs,Side %in% c("pmRight","pmLeft")),alternative="two.sided",paired=TRUE,var.equal=TRUE)
t.test(Mean_tSNR~Side,data=filter(tsnr.ROIs,Side %in% c("pmRight","alRight")),alternative="two.sided",paired=TRUE,var.equal=TRUE)
grid.tStab.all.runs <- grid.tStability.sep %>%
filter(!RunComparison %in% c("allRunsAvgVSrun1","allRunsAvgVSrun2","allRunsAvgVSrun3"))
grid.tStab.allRuns <- grid.tStability.sep %>%
filter(RunComparison %in% c("allRunsAvgVSrun1","allRunsAvgVSrun2","allRunsAvgVSrun3"))
grid.tStab.main.runs <- grid.tStab.all.runs %>%
filter(Model %in% c("pmRight6","pmLeft6","pmBoth6"))
ggplot(grid.tStab.main.runs,aes(Age,Grid_tStability)) +
geom_jitter() +
facet_wrap(~Model) +
geom_smooth(aes(colour="Grid_tStability"),method=lm) +
scale_colour_brewer(palette="Spectral") +
labs(title="Association of grid temporal stability across all runs with age")
grid.sStab.z.all.allRuns <- grid.sStability.z.sep %>%
filter(!Run %in% c("run1","run2","run3"))
grid.sStab.z.main.allRuns <- grid.sStab.z.all.allRuns %>%
filter(Model %in% c("pmRight6","pmLeft6","pmBoth6"))
ggplot(grid.sStab.z.main.allRuns,aes(Age,Grid_sStabilityZ)) +
geom_jitter() +
facet_wrap(~Model) +
geom_smooth(method=lm) +
labs(title="Association of grid spatial stability across all runs with age")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
labs(title = "Grid cell like signal magnitude highest in right posteromedial EC") +
scale_fill_discrete(name = "Region", labels = c("Left alEC","Left pmEC", "Right alEC","Right pmEC"))
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
labs(title = "Grid cell like signal magnitude highest in right posteromedial EC", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Left alEC","Left pmEC", "Right alEC","Right pmEC")) +
labs(title = "Grid cell like signal magnitude highest in right posteromedial EC", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Left anterolateral EC","Left posteromedial EC", "Right anterolateral EC","Right posteromedial EC")) +
labs(title = "Grid cell like signal magnitude highest in right posteromedial EC", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signal magnitude highest in right posteromedial EC", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6,show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd, show.legend = FALSE) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu", guide = FALSE) +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
guides(group = FALSE) +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
guides(colour = FALSE) +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu", guides(group=FALSE)) +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd, show.legend = FALSE) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC"),guide=FALSE) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC"),guides(fill=FALSE)) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu") +
scale_fill_discrete(name = "Age Group", breaks = c("Young","Old"), labels = c("Young","Old")) +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_discrete(name = "Age Group", breaks = c("Young","Old"), labels = c("Young","Old")) +
scale_fill_brewer(palette="YlGnBu") +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
#scale_fill_discrete() +
scale_fill_brewer(palette="YlGnBu",name = "Age Group", breaks = c("Young","Old"), labels = c("Young","Old")) +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu",name = "Age Group", breaks = c("Young","Old"), labels = c("Young","Old")) +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
ggplot(grid.mag.ROIcontrols.allRuns, aes(Model,Grid_Magnitude)) +
geom_boxplot(aes(fill=Model),outlier.shape = NA,alpha=0.6, show.legend = FALSE) +
geom_line(aes(group=Subject), alpha=0.4, position = pd) +
geom_point(aes(fill=Age_Group,group=Subject),size=2,shape=21,position = pd) +
facet_grid(~Side,scales = "free") +
scale_fill_brewer(palette="YlGnBu",name = "Age Group", breaks = c("Young","Old"), labels = c("Young","Old")) +
scale_x_discrete(labels = c("Anterolateral EC","Posteromedial EC", "Anterolateral EC","Posteromedial EC")) +
labs(title = "Grid cell like signals at 7T fMRI", x = "Region", y = "Magnitude of Grid-like Signal")
## PIT analysis
require(ggplot2)
require(dplyr)
require(tibble)
require(readr)
require(tidyr)
require(RColorBrewer)
require(ggthemes)
require(lme4)
resultsDir <- '/lustre/scratch/wbic-beta/ccn30/ENCRYPT/results/PIT'
scriptDir <- '/lustre/scratch/wbic-beta/ccn30/ENCRYPT/scripts/PIT/slurmoutputs'
setwd(scriptDir)
csvFiles <- list.files(resultsDir,pattern="*.csv",full.names=1)
nFiles <- length(csvFiles)
# make master table
for(i in 1:nFiles)
{
output[i] <- paste("csv",i,sep="")
assign(output[i], as_tibble(read.csv(csvFiles[i])))
}
for(i in 1:nFiles)
{
output[i] <- paste("csv",i,sep="")
assign(output[i], as_tibble(read.csv(csvFiles[i])))
}
assign(output, as_tibble(read.csv(csvFiles[i])))
for(i in 1:nFiles)
{
output <- paste("csv",i,sep="")
assign(output, as_tibble(read.csv(csvFiles[i])))
}
?mget
get(csv*)
get(csv)
get(csv1)
list=lapply(csvFiles,read_csv)
View(list)
list[[1]]
list{1}
list[1]
list[1:35]
bind_rows(list[1:35])
PITall <- bind_rows(list[1:35])
View(PITall)
## PIT analysis
require(ggplot2)
## PIT analysis
require(ggplot2)
require(dplyr)
require(tibble)
require(readr)
require(tidyr)
require(RColorBrewer)
require(ggthemes)
require(lme4)
resultsDir <- '/lustre/scratch/wbic-beta/ccn30/ENCRYPT/results/PIT'
scriptDir <- '/lustre/scratch/wbic-beta/ccn30/ENCRYPT/scripts/PIT/slurmoutputs'
setwd(scriptDir)
csvFiles <- list.files(resultsDir,pattern="*.csv",full.names=1)
# make master table
nFiles <- length(csvFiles)
tibblesList=lapply(csvFiles,read_csv)
PITall <- bind_rows(tibblesList[1:nFiles])
PITall <- bind_rows(tibblesList)
PITall2 <- bind_rows(tibblesList)
?lapply
